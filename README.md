# Multivariate Normal

多次元正規分布からのサンプリングをする。  
numpy の multivariate_normal では中で SVD を行っており、  
これが原因で稀に "SVD did not converge" で死ぬ。  
ホントは SVD ではんくて Cholesky 分解でよいので自分で実装した。

## 多次元正規分布

d = 次元数  
m = 平均ベクトル  
C = 分散共分散行列 (ただし、C は半正定値対称行列)  
N_d(m, C) = d 次元正規分布  

## 多次元正規分布の性質

x ~ N_d(m, C) ならば、任意の a \in R^d に対して、  
dot(a, x) は正規分布に従う。

## 条件付き分布

p(x ; m, C) = N_d(m, C) とする。
今、x は２つのベクトル x1, x2 に分解可能とする。
x2 の値が v であることを観測したときの x1 の条件付き分布は以下の多次元正規分布に従う。

    x1 | x2 = v ~ N_q(m', C')
    m' = m1  + C12 C22^-1 (v - m2)
    C' = C11 + C12 C22^-1 C21

    m = [m1, m2]
    C = [ [C11, C12]
          [C21, C22] ]

## 多次元正規分布からのサンプリング

### Gibbs Sampling

x_i 以外の値を固定した条件付き分布からのサンプリングを繰り返すことで  
N_d(m, C) からのサンプリングを実現する。  
とにかく遅いし近似である。


### Cholesky 分解を利用した Sampling

C = LL^T なる L を C の Cholesky 分解と言う。  
x を標準性分布 N(0, 1) からの独立な d 個のサンプルとする。  
すると m + dot(L, x) は N_d(m, C) に従う。  
すごいけどちゃんと確認してない。
